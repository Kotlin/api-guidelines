<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  <meta charset="UTF-8">   <meta name="built-on" content="${builtOn}">   <title>Debuggabilityâ€”API guidelines</title><script id="virtual-toc-data" type="application/json">[{"id":"always-provide-a-tostring-method","level":0,"title":"Always provide a toString() method","anchor":"#always-provide-a-tostring-method"},{"id":"what-s-next","level":0,"title":"What\u0027s next?","anchor":"#what-s-next"}]</script>     <link href="api-guidelines/app/app.css%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a.css" rel="stylesheet">   <link rel="shortcut icon" href="https://resources.jetbrains.com/storage/ui/favicons/favicon.ico" type="image/x-icon" sizes="16x16 32x32"/><link rel="apple-touch-icon" sizes="57x57" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="https://resources.jetbrains.com/storage/ui/favicons/apple-touch-icon-180x180.png"/><link rel="mask-icon" href="https://resources.jetbrains.com/storage/ui/favicons/apple-mask-icon.svg" color="black"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="${ogMetaImage}"><!-- Open Graph --><meta property="og:title" content="Debuggability - Help | API guidelines"/><meta property="og:description" content=""/><meta property="og:image" content="${ogMetaImage}"/><meta property="og:site_name" content="API guidelines Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="${ogUrl}"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="${ogTwitter}"><meta name="twitter:title" content="Debuggability - Help | API guidelines"><meta name="twitter:description" content=""><meta name="twitter:creator" content="${ogTwitter}"><meta name="twitter:image:src" content="${ogMetaImage}"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "${ogUrl}#webpage", "url": "${ogUrl}", "name": "Debuggability - Help | API guidelines", "description": "", "image": "${ogMetaImage}", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "${ogUrlRoot}#website", "url": "${ogUrlRoot}", "name": "API guidelines Help" }</script><!-- End Schema.org --></head>    <body data-id="jvm-api-guidelines-debuggability" data-main-title="Debuggability" data-article-props="{&quot;microFormat&quot;:[],&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs=""  data-edit-url="https://github.com/Kotlin/api-guidelines/edit/main/docs/topics/jvm-api-guidelines-debuggability.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>API guidelines  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="jvm-api-guidelines-debuggability" id="jvm-api-guidelines-debuggability.md"  >Debuggability</h1><p id="215b" >This chapter contains considerations about debuggability.</p> <section class="chapter" >  <h2 id="always-provide-a-tostring-method" data-toc="jvm-api-guidelines-debuggability#always-provide-a-tostring-method" >Always provide a toString() method</h2><p id="2164" >To make debugging easier, add a <code class="code " id="2168"  >toString()</code> implementation to every class you introduce, even to internal ones. If <code class="code " id="216c"  >toString()</code> is part of a contract, document it explicitly.</p> <p id="2170" >The following code is a simplified example from a graphical modeling area:</p> <div class="code-block" data-lang="kotlin" id="2178"       >  class Vector2D(val x: Int, val y: Int)

fun main() {
    val result = (1..20).map { Vector2D(it, it) }
    println(result)
}
  </div> <p id="217d" >The output of this code is not very useful:</p> <div class="code-block" data-lang="none" id="2185"      data-disable-link-processing="true" >  [Vector2D@27bc2616, Vector2D@3941a79c, Vector2D@506e1b77,...]
  </div> <p id="218a" >Neither is the information provided in the debug tool window:</p> <p id="218e" ><figure  class=" " id="2192"><img alt="Vector class objects in the debug tool window" title="Vector class objects in the debug tool window" src="api-guidelines/vector-objects-in-debug.png%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a" id="2192" class="  "  width="500" height="196" /></figure></p> <p id="2199" >To make both logging and debugging much more readable, add a simple <code class="code " id="219d"  >toString()</code> implementation like this:</p> <div class="code-block" data-lang="kotlin" id="21a5"       >  override fun toString(): String {
    return &quot;Vector2D(x=$x, y=$y)&quot;
}
  </div> <p id="21aa" >This results in improved output:</p> <div class="code-block" data-lang="none" id="21b2"      data-disable-link-processing="true" >  [Vector2D(x=1, y=1), Vector2D(x=2, y=2), Vector2D(x=3, y=3), ...
  </div> <p id="21b7" ><figure  class=" " id="21bb"><img alt="Improved output of vector class objects in the debug tool window" title="Improved output of vector class objects in the debug tool window" src="api-guidelines/improved-output-of-vector-objects-in-debug.png%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a" id="21bb" class="  "  width="500" height="206" /></figure></p> <aside data-type="note" class="prompt" data-title="" id="21c2" ><p id="21c7" >It might seem a good idea to use <a href="https://kotlinlang.org/docs/data-classes.html" data-external="true" id="21cb" rel="noopener noreferrer" >data classes</a> because they have a <code class="code " id="21d1"  >toString()</code> method automatically. In the <a href="jvm-api-guidelines-backward-compatibility.html" id="21d5"  >Backward compatibility</a> section of this guide, you'll learn <a href="jvm-api-guidelines-backward-compatibility.html#don-t-use-data-classes-in-api" id="21db"  >why it's better not to do this</a>.</p></aside> <p id="21e1" >Consider implementing <code class="code " id="21e5"  >toString()</code> even if you don't think the class is going to be printed anywhere, as it can help in unexpected ways. For example, inside <a href="https://en.wikipedia.org/wiki/Builder_pattern#:~:text=The%20builder%20pattern%20is%20a,Gang%20of%20Four%20design%20patterns" data-external="true" id="21e9" rel="noopener noreferrer" >builders</a>, it sometimes may be important if it's the same builder or a new one.</p> <div class="code-block" data-lang="kotlin" id="21f3"       >  class Person(
    val name: String?,
    val age: Int?,
    val children: List&lt;Person&gt;
) {
    override fun toString(): String {
        return &quot;Person(name=$name, age=$age, children=$children)&quot;
    }
}

class PersonBuilder {
    var name: String? = null
    var age: Int? = null
    val children = arrayListOf&lt;Person&gt;()
    fun child(personBuilder: PersonBuilder.() -&gt; Unit = {}) {
        children.add(person(personBuilder))
    }
}

fun person(personBuilder: PersonBuilder.() -&gt; Unit = {}): Person {
    val builder = PersonBuilder()
    builder.personBuilder()
    return Person(builder.name, builder.age, builder.children)
}
  </div> <p id="21f8" >The intended use of the code above is the following:</p> <p id="21fc" ><figure  class=" " id="2200"><img alt="Usage of the person DSL and a breakpoint" title="Usage of the person DSL and a breakpoint" src="api-guidelines/breakpoint-for-person.png%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a" id="2200" class="  "  width="500" height="245" /></figure></p> <p id="2207" >If you set a breakpoint on the line after a closing bracket of the first <code class="code " id="220b"  >child</code> (as on the picture above), you see a non-descriptive string in debug output:</p> <p id="220f" ><figure  class=" " id="2213"><img alt="Result of a PersonBuilder debugging" title="Result of a PersonBuilder debugging" src="api-guidelines/debug-person-builder.png%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a" id="2213" class="  "  width="500" height="34" /></figure></p> <p id="221a" >If you add a simple <code class="code " id="221e"  >toString()</code> implementation like this:</p> <div class="code-block" data-lang="kotlin" id="2226"       >  override fun toString(): String {
    return &quot;PersonBuilder(name=$name, age=$age, children=$children)&quot;
}
  </div> <p id="222b" >The debug data becomes much clearer:</p> <p id="222f" ><img alt="Result of a PersonBuilder improved debugging" title="Result of a PersonBuilder improved debugging" src="api-guidelines/debug-person-builder-improved.png%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a" id="2233" class="  inline-icon-24 " width="700" height="24" /></p> <p id="223a" >You can also see immediately which fields are set and which are not.</p> <aside data-type="warning" class="prompt" data-title="" id="223e"><p id="2243" >Be careful with exposing fields in <code class="code " id="2247"  >toString()</code> because sometimes it's easy to get a <code class="code " id="224b"  >StackOverflowException</code>. For example, if <code class="code " id="224f"  >children</code> has a reference to a parent, that would create a circular reference. Also, be careful about exposing lists and maps as <code class="code " id="2253"  >toString()</code> can expand a deeply-nested hierarchy.</p></aside>  </section><section class="chapter" >  <h2 id="what-s-next" data-toc="jvm-api-guidelines-debuggability#what-s-next" >What's next?</h2><p id="225c" >Learn about API's <a href="jvm-api-guidelines-backward-compatibility.html" id="2260"  >backward compatibility</a></p>  </section><div class="last-modified"> Last modified: 10 April 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">   </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="api-guidelines/app/app.js%3F_ijt=lfaskikimisqhp7sdvdbgm8l0a"></script></body></html>